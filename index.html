<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <button id="btnExport" onClick="fnExcelReport()">Export to xls</button>
<br />
<br />

<table id="theTable">
  <tbody>
    <tr class="header">
      <th>Heading 1</th>
      <th>Heading 2</th>
      <th>Heading 3</th>
    </tr>
    <tr>
      <td>1, Cell 1</td>
      <td>1, Cell 2</td>
      <td>1, Cell 3</td>
    </tr>
    <tr>
      <td>2, Cell 1</td>
      <td>2, Cell 2</td>
      <td>2, Cell 3</td>
    </tr>
    <tr>
      <td>3, Cell 1</td>
      <td>3, Cell 2</td>
      <td>3, Cell 3</td>
    </tr>
  </tbody>
</table>

<iframe id="dummyFrame" style="display:none"></iframe>
</body>
</html>

<script>
    function fnExcelReport() {
        var table = document.getElementById('theTable'); // id of table
        var tableHTML = table.outerHTML;
        var fileName = 'download.xls';

        var msie = window.navigator.userAgent.indexOf("MSIE ");

        // If Internet Explorer
        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
            dummyFrame.document.open('txt/html', 'replace');
            dummyFrame.document.write(tableHTML);
            dummyFrame.document.close();
            dummyFrame.focus();
            return dummyFrame.document.execCommand('SaveAs', true, fileName);
        }
        //other browsers
        else {
            var a = document.createElement('a');
            tableHTML = tableHTML.replace(/  /g, '').replace(/ /g, '%20'); // replaces spaces
            a.href = 'data:application/vnd.ms-excel,' + tableHTML;
            a.setAttribute('download', fileName);
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    }
</script>